{% extends "main.html" %}
{% load humanize %}{% load filters %}

{% block title %}Usage{% endblock %}

{% block content_title %}{% endblock %}

{% block bread_crumbs_1 %}
 &rsaquo; Usage
{% endblock %}

{% block content %}
<div id="content-main">
<h2>Usage {{ start|date }} - {{ end|date }}</h2>
<ul class="object-tools">
<li><a href="institute/trends/?{{ querystring }}">Trends</a></li>
<li><a href="top_users/?{{ querystring }}">Top Users</a></li>
<li><a href="{% url ac_usage_search %}" class="viewsitelink">Advanced Search</a></li>
</ul>
<p>
{% date_filter start end %}
</p>
<p>No. CPU's: (average) {{ avg_cpus|floatformat:"1"  }}  Utilization: {{ utilization|floatformat:"2" }}%</p>
<p>Total time {{ total|timeformat }} ({{ total_jobs|intcomma }} jobs) of available {{ available_time|timeformat }} </p>

	<div class="module">	
   	<h2>Institutes</h2>
   	<table>
			<thead>
			<tr>
				<th>Institute</th>
				<th>CPU Time</th>
				<th>No. Jobs</th>
				<th>Actual</th>
				<th>Quota</th>
				<th>Difference</th>
				<th>% quota used</th>
			</tr>   	
   	</thead>
   	<tbody>
   	
   	{% for i in i_list|dictsortreversed:"usage" %}
			<tr class="{% cycle row1,row2 as rowcolours %}">
				<td><a href="institute/{{ i.institute.id }}/?{{ querystring }}">{{ i.institute.name }}</a> </td>
				<td class="right">{{ i.usage|timeformat }}</td>	
				<td class="right">{{ i.jobs|intcomma }}</td>	
				<td class="right">{{ i.percent|floatformat:"2" }}</td>
				<td class="right">{{ i.quota }}</td>
				<td class="right {{ i.class }}">{{ i.diff|floatformat:"2" }}</td>
				<td class="right {{ i.class }}">{{ i.p_used|floatformat:"2" }}</td>
			</tr> 
		{% endfor %}
			<tr class="{% cycle rowcolours %}">
				<td>Unused</td>
				<td class="right">{{ unused.usage|timeformat }}</td>	
				<td class="right">&nbsp;</td>	
				<td class="right">{{ unused.percent|floatformat:"2" }}</td>
				<td class="right">&nbsp;</td>
				<td class="right {{ unused.class }}">{{ unused.diff|floatformat:"2" }}</td>
				<td>&nbsp;</td>
			</tr> 
   	</tbody>
   	</table>
	</div>
	
	{% ifequal machine_category.id 1 %}
	<p><a href="summary_report/?{{ querystring }}">Report</a></p>
	{% endifequal %}
	<img src="{{ MEDIA_URL }}graphs/{{ graph }}" /><br clear="all" />
	{% ifequal machine_category.id 1 %}
	<img src="{{ MEDIA_URL }}graphs/quota_pie.png" /><br clear="all" />
	{% endifequal %}
	<img src="{{ MEDIA_URL }}graphs/{{ trend_graph }}" />
	
	
</div>
{% endblock %}
